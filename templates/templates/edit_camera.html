<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Modifier la Caméra</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body style="background-color: #f4f4f4;">
    <nav class="navbar navbar-dark bg-dark mb-4">
        <a class="navbar-brand" href="/">Mon VMS Web</a>
        <div>
            <a class="nav-item nav-link d-inline-block" href="/config">Configuration</a>
            <a class="nav-item nav-link d-inline-block" href="/recordings_hub">Liste des Enregistrements</a>
        </div>
    </nav>
    <div class="container" style="max-width: 800px;">
        <h1 class="mb-4">Modifier la caméra : {{ camera.name }}</h1>
        <div class="card">
            <div class="card-body">
                <form action="{{ url_for('update_camera', cam_id=cam_id) }}" method="post">
                    <div class="form-group"><label>Nom</label><input type="text" class="form-control" name="camera_name" value="{{ camera.name }}" required></div>
                    <div class="form-group"><label>URL SD</label><input type="text" class="form-control" name="camera_url_sd" value="{{ camera.url_sd }}" required></div>
                    <div class="form-group"><label>URL HD</label><input type="text" class="form-control" name="camera_url_hd" value="{{ camera.url_hd }}" required></div>
                    <div class="form-group">
                        <label>Sensibilité</label><input type="number" class="form-control" name="sensitivity" value="{{ camera.get('sensitivity', 1000) }}" min="100" max="10000" step="100" required>
                        <small class="form-text text-muted">Min: 100 (très sensible), Max: 10000 (peu sensible).</small>
                    </div>
                    <div class="form-group form-check">
                        <input type="checkbox" class="form-check-input" name="is_active" id="is_active_edit" value="true" {% if camera.get('is_active', True) %}checked{% endif %}>
                        <label class="form-check-label" for="is_active_edit">Activer la surveillance (flux direct)</label>
                    </div>
                    <div class="form-group form-check">
                        <input type="checkbox" class="form-check-input" name="is_recording_enabled" id="is_recording_enabled_edit" value="true" {% if camera.get('is_recording_enabled', True) %}checked{% endif %}>
                        <label class="form-check-label" for="is_recording_enabled_edit">Activer l'enregistrement sur détection</label>
                    </div>
                    <!-- NOUVEAU : Case à cocher pour le visuel de détection -->
                    <div class="form-group form-check">
                        <input type="checkbox" class="form-check-input" name="show_detection" id="show_detection_edit" value="true" {% if camera.get('show_detection', True) %}checked{% endif %}>
                        <label class="form-check-label" for="show_detection_edit">Afficher le carré rouge de détection</label>
                    </div>
                    <button type="submit" class="btn btn-primary">Sauvegarder</button>
                    <a href="/config" class="btn btn-secondary">Annuler</a>
                </form>
            </div>
        </div>
    </div>
</body>
</html>